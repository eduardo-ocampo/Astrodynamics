<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>Python Examples</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/css/theme.css " type="text/css" />
          <link rel="stylesheet" href="../_static/mystnb.css" type="text/css" />
          <link rel="stylesheet" href="../_static/togglebutton.css" type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Examples of Rendering Plots in HTML" href="../plot_example.html" />
  <link rel="prev" title="Integrals of Motion" href="Integrals_Of_Motion.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">Workspace</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link ">
         welcome to eddie’s documentation!
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link ">
         welcome to eddie’s documentation!
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link ">
         Newton's Law of Gravitation
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link  router-link-active">
         Classical Orbital Elements
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link ">
         welcome to eddie’s documentation!
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link ">
         welcome to eddie’s documentation!
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link ">
         Newton's Law of Gravitation
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#welcome-to-eddies-documentation"
         class="nav-link  router-link-active">
         Classical Orbital Elements
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-eddies-documentation">welcome to eddie’s documentation!</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../intro.html" class="reference internal ">An Intro</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-eddies-documentation">welcome to eddie’s documentation!</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../Math_Example.html" class="reference internal ">An Attempt To Show Math</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-eddies-documentation">Newton's Law of Gravitation</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../Newtons_Law_Of_Gravitation.html" class="reference internal ">Newton’s Law of Gravitation</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#welcome-to-eddies-documentation">Classical Orbital Elements</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="Orbit_Elements.html" class="reference internal ">Orbit Elements</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="Integrals_Of_Motion.html" class="reference internal ">Integrals of Motion</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Python Examples</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#calculating-orbital-elements" class="reference internal">Calculating Orbital Elements</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="../plot_example.html" class="reference internal ">Examples of Rendering Plots in HTML</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>Python Examples</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="Integrals_Of_Motion.html"
       title="previous chapter">← Integrals of Motion</a>
  </li>
  <li class="next">
    <a href="../plot_example.html"
       title="next chapter">Examples of Rendering Plots in HTML →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="python-examples">
<h1>Python Examples<a class="headerlink" href="#python-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="calculating-orbital-elements">
<h2>Calculating Orbital Elements<a class="headerlink" href="#calculating-orbital-elements" title="Permalink to this headline">¶</a></h2>
<p>Provide some intro, what position and velocity vector we’ll be using. As Elements are shown consider writing out outputs and then summarizing at the end of them all. Talk about what units are assume (SI) km/s etc.</p>
<p>Consider a statelitte orbiting earth. Let’s assume we have recieved the following data about it’s position and velocity vector at some time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Postion</span><span class="p">:</span>  <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="n">km</span>

<span class="n">Velocity</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.324555</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="n">km</span><span class="o">/</span><span class="n">sec</span>

</pre></div>
</div>
<p>In the inertial coorindate frame this can be written as:</p>
<div class="math notranslate nohighlight">
\[\mathbf{r} = 10000 \space \mathbf{\hat{i}} + 1000 \space \mathbf{\hat{j}} + 0.0 \space \mathbf{\hat{k}} \space \space {km}\]</div>
<div class="math notranslate nohighlight">
\[\mathbf{v} = 1.0 \space \mathbf{\hat{i}} + 6.324555 \space \mathbf{\hat{j}} + 1.0 \space \space \mathbf{\hat{k}} \space \space \frac{km}{s}\]</div>
<p>Let’s determine the Sat’s Orbital Elements using Python package twoBodyProblem.py</p>
<p>Begin by importing moduel twoBodyProblem and defining the postion and state vector. Module twoBodyProblem.py requires an output file to be assigned as attribute <code class="docutils literal notranslate"><span class="pre">resultsOut</span></code>. Calling getElements() will calculate Orbital Elements of your State Vector while writeResults() will write out the results.</p>
<div class="section" id="script-setup">
<h3>Script Setup<a class="headerlink" href="#script-setup" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">twoBodyProblem</span> <span class="kn">import</span> <span class="n">orbitElements</span>

<span class="c1"># Initial Position and Velocity Vectors</span>
<span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="c1"># km</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.324555</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="c1"># km/s</span>

<span class="c1"># Instantiate orbitElements Class</span>
<span class="n">orbitElements</span> <span class="o">=</span> <span class="n">orbitElements</span><span class="p">(</span><span class="n">position</span><span class="p">,</span><span class="n">velocity</span><span class="p">)</span>
<span class="n">orbitElements</span><span class="o">.</span><span class="n">resultsOut</span> <span class="o">=</span> <span class="s2">&quot;Example.results&quot;</span>

<span class="c1"># Calculate Orbital Elements and Save Results Out</span>
<span class="n">orbitElements</span><span class="o">.</span><span class="n">getElements</span><span class="p">()</span>
<span class="n">orbitElements</span><span class="o">.</span><span class="n">writeResults</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Exampl.results File Contents</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Initial</span> <span class="n">State</span> <span class="n">Vectors</span><span class="p">:</span>
<span class="o">----------------------------------------</span>
<span class="n">Position</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="n">km</span>
<span class="n">Velocity</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">6.324555</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="n">km</span><span class="o">/</span><span class="n">sec</span>


<span class="n">Computed</span> <span class="n">Results</span>
<span class="n">Element</span>                            <span class="n">Value</span>          <span class="n">Units</span>
<span class="o">-------------------------------------------------------</span>
<span class="n">Position</span> <span class="n">Magnitude</span>                 <span class="mi">10050</span>             <span class="n">km</span>
<span class="n">Velocity</span> <span class="n">Magnitude</span>                <span class="mf">6.4807</span>         <span class="n">km</span><span class="o">/</span><span class="n">sec</span>
<span class="n">Energy</span>                           <span class="o">-</span><span class="mf">18.662</span>     <span class="n">km</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">sec</span><span class="o">^</span><span class="mi">2</span>
<span class="n">Angular</span> <span class="n">Momentum</span>                   <span class="mi">63052</span>       <span class="n">km</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">sec</span>
<span class="n">Eccentricity</span>                     <span class="mf">0.25706</span>               
<span class="n">Inclination</span>                       <span class="mf">9.1716</span>        <span class="n">degrees</span>
<span class="n">Long</span><span class="o">.</span> <span class="n">of</span> <span class="n">Ascend</span><span class="o">.</span> <span class="n">Node</span> <span class="p">(</span><span class="n">Ω</span><span class="p">)</span>         <span class="mf">5.7106</span>        <span class="n">degrees</span>
<span class="n">Argument</span> <span class="n">of</span> <span class="n">Perigee</span> <span class="p">(</span><span class="n">ω</span><span class="p">)</span>           <span class="mf">268.31</span>        <span class="n">degrees</span>
<span class="n">Semi</span><span class="o">-</span><span class="n">Major</span> <span class="n">Axis</span>                    <span class="mi">10679</span>             <span class="n">km</span>
<span class="n">Mean</span> <span class="n">Motion</span>                   <span class="mf">0.00057207</span>        <span class="n">rad</span><span class="o">/</span><span class="n">sec</span>
<span class="kc">True</span> <span class="n">Anomaly</span>                       <span class="mf">91.69</span>        <span class="n">degrees</span>
<span class="n">Eccentric</span> <span class="n">Anomaly</span>                 <span class="mf">76.744</span>        <span class="n">degrees</span>
<span class="n">Mean</span> <span class="n">Anomaly</span>                      <span class="mf">62.408</span>        <span class="n">degrees</span>
<span class="n">Period</span>                            <span class="mf">3.0509</span>          <span class="n">hours</span>

</pre></div>
</div>
<p>All code blocks below are refereenced from Class orbitElements() in <code class="docutils literal notranslate"><span class="pre">twoBodyProblem.orbitElements()</span></code>.</p>
<p>Their magnitudes are calulcated in twoBodyProblem.py using <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">numpy.linalg</span> <span class="pre">import</span> <span class="pre">norm</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">posVector</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">velVector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="anguluar-momentum">
<h3>Anguluar Momentum<a class="headerlink" href="#anguluar-momentum" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\mathbf{h} = \mathbf{r} \times \mathbf{v}\]</div>
<p>Utilizes <a class="reference external" href="https://numpy.org/">NumPy</a> packages to perfrom cross product.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Specific Angular Momentum Vector</span>
<span class="c1"># --------------------------------------------------------------------------------  </span>
<span class="n">ang_momentum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">orbit_elements</span><span class="p">[</span><span class="s2">&quot;Angular Momentum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">norm</span><span class="p">(</span><span class="n">ang_momentum</span><span class="p">),</span> 
                                           <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;km^2/sec&quot;</span><span class="p">}</span>

</pre></div>
</div>
</div>
<div class="section" id="inclination">
<h3>Inclination<a class="headerlink" href="#inclination" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[i = \cos^{-1}\left(\frac{\mathbf{\hat{z}}}{\mathbf{\hat{h}}}\right)\]</div>
<p>Utilizes <a class="reference external" href="https://numpy.org/">NumPy</a> packages to perfrom inverser trigometric functions and dot product. np.arccos() returns the angle of the ray intersecting the unit circle at the given x-coordinate in radians (0, <span class="math notranslate nohighlight">\(\pi\)</span>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Inclination</span>
<span class="c1"># --------------------------------------------------------------------------------</span>
<span class="n">incl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">ang_momentum</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">ang_momentum</span><span class="p">))</span>
<span class="bp">self</span><span class="o">.</span><span class="n">orbit_elements</span><span class="p">[</span><span class="s2">&quot;Inclination&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">incl</span><span class="p">),</span> 
                                      <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ascending-node-vector">
<h3>Ascending Node Vector<a class="headerlink" href="#ascending-node-vector" title="Permalink to this headline">¶</a></h3>
<p>Maybe add this?</p>
</div>
<div class="section" id="longitude-of-ascending-node">
<h3>Longitude of Ascending Node<a class="headerlink" href="#longitude-of-ascending-node" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{\Omega} = \begin{cases}
\cos^{-1}\left(\frac{\mathbf{\hat{x}}}{\mathbf{\hat{n}}}\right) &amp; \mathbf{\hat{n}_y} \geq 0^{\circ} \\
360^{\circ} - \cos^{-1}\left(\frac{\mathbf{\hat{x}}}{\mathbf{\hat{n}}}\right) &amp; \mathbf{\hat{n}_y} &lt; 0^{\circ}
\end{cases}\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># Longitude of Ascending Node (Ω)</span>
<span class="c1"># --------------------------------------------------------------------------------   </span>
<span class="n">long_ascend_node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">node_vec</span><span class="p">)</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">node_vec</span><span class="p">))</span>

<span class="k">if</span> <span class="n">node_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
    <span class="n">lan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">long_ascend_node</span><span class="p">))</span>
<span class="k">elif</span> <span class="n">node_vec</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
    <span class="n">lan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">norm</span><span class="p">(</span><span class="n">long_ascend_node</span><span class="p">))</span>
<span class="bp">self</span><span class="o">.</span><span class="n">orbit_elements</span><span class="p">[</span><span class="s2">&quot;Long. of Ascend. Node (Ω)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">lan</span><span class="p">,</span> 
                    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="specific-energy">
<h3>Specific Energy<a class="headerlink" href="#specific-energy" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\varepsilon = \frac{v^2}{2} - \frac{\mu}{r}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specific Energy</span>
<span class="c1"># --------------------------------------------------------------------------------   </span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="o">/</span><span class="n">r</span> 
<span class="bp">self</span><span class="o">.</span><span class="n">orbit_elements</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">energy</span><span class="p">,</span> 
                                 <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;km^2/sec^2&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="eccentricity-vector">
<h3>Eccentricity Vector<a class="headerlink" href="#eccentricity-vector" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\mathbf{e} = \frac{1}{\mu}\left(\mathbf{v}\times\mathbf{h}\right) - \frac{\mathbf{r}}{r}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eccentricity Vector</span>
<span class="c1"># --------------------------------------------------------------------------------   </span>
<span class="n">eccentricity</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span><span class="n">ang_momentum</span><span class="p">))</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">/</span><span class="n">r</span>
<span class="bp">self</span><span class="o">.</span><span class="n">orbit_elements</span><span class="p">[</span><span class="s2">&quot;Eccentricity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">norm</span><span class="p">(</span><span class="n">eccentricity</span><span class="p">),</span> 
                                        <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="argument-of-perigee">
<h3>Argument of Perigee<a class="headerlink" href="#argument-of-perigee" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Argument of Perigee (ω)</span>
<span class="c1"># --------------------------------------------------------------------------------   </span>
<span class="n">arg_peri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">node_vec</span><span class="p">,</span><span class="n">eccentricity</span><span class="p">)</span> <span class="o">/</span> 
                    <span class="p">(</span><span class="n">norm</span><span class="p">(</span><span class="n">eccentricity</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">node_vec</span><span class="p">)))</span>
<span class="c1"># Check ecc_zcomp</span>
<span class="k">if</span> <span class="n">eccentricity</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">arg_peri</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">arg_peri</span>
<span class="bp">self</span><span class="o">.</span><span class="n">orbit_elements</span><span class="p">[</span><span class="s2">&quot;Argument of Perigee (ω)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">arg_peri</span><span class="p">),</span> 
                                                    <span class="s2">&quot;units&quot;</span><span class="p">:</span> <span class="s2">&quot;degrees&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="Integrals_Of_Motion.html"
       title="previous chapter">← Integrals of Motion</a>
  </li>
  <li class="next">
    <a href="../plot_example.html"
       title="next chapter">Examples of Rendering Plots in HTML →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2022, Eddie.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>